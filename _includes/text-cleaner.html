<div id="text-cleaner-app">
  <textarea
    id="inputText"
    rows="8"
    style="width:100%;"
    placeholder="Type or paste text here..."
  ></textarea>

  <br><br>

  <textarea
    id="outputText"
    rows="8"
    style="width:100%;"
    placeholder="Cleaned text appears here..."
    readonly
  ></textarea>
</div>

<script>
(function () {
  console.log("Text cleaner include loaded");

  function initTextCleaner() {
    const input = document.getElementById("inputText");
    const output = document.getElementById("outputText");

    if (!input || !output) {
      console.error("Text cleaner: elements not found");
      return;
    }

    input.addEventListener("input", function () {
      let text = input.value;

      // Collapse multiple spaces
      text = text.replace(/\s{2,}/g, " ");

      // Capitalize first letter of each sentence
      text = text.replace(
        /(^\s*[a-z])|([.!?]\s+[a-z])/g,
        m => m.toUpperCase()
      );

      output.value = text;
    });

    console.log("Text cleaner initialized");
  }

  if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", initTextCleaner);
  } else {
    initTextCleaner();
  }
})();
</script>
